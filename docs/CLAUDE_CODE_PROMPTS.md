# Claude Code用プロンプト集

このファイルには、Claude Codeで開発を進めるためのプロンプトが含まれています。
順番に実行することで、段階的にアプリを構築できます。

---

## 事前準備プロンプト

### プロジェクト理解
```
このプロジェクトの構造を確認してください。
- docs/REQUIREMENTS.md に要件定義があります
- data/accounting.db にSQLiteデータベースがあります
- scripts/ に既存のデータ処理スクリプトがあります

まず REQUIREMENTS.md を読んで、プロジェクトの概要を把握してください。
その後、accounting.db のテーブル構造とサンプルデータを確認してください。
```

---

## Phase 2-1: 基本UI構築

### プロンプト 2-1-A: プロジェクト構造作成
```
会計データ可視化アプリの基本構造を作成してください。

要件:
- app/ ディレクトリ配下に以下の構造を作成
  - main.py: エントリーポイント
  - views/: 画面コンポーネント
  - models/: データアクセス層
  - utils/: ユーティリティ
- CustomTkinterを使用
- 日本語UIに対応

まずは空のウィンドウが表示されるところまで実装してください。
ウィンドウタイトルは「会計データ可視化ダッシュボード」、サイズは1280x800です。
```

### プロンプト 2-1-B: フィルタパネル実装
```
左サイドバーにフィルタパネルを実装してください。

フィルタ項目:
1. 年度選択（チェックボックス、複数選択可）
   - データベースから年度リストを取得
   - デフォルトは全選択
2. セグメント選択（チェックボックス、複数選択可）
   - データベースからセグメントリストを取得
3. 科目選択（ドロップダウン、単一選択）
   - デフォルトは「売上高」

フィルタの値が変更されたときにコールバック関数が呼ばれるようにしてください。
データベースは data/accounting.db にあります。
```

### プロンプト 2-1-C: タブ構造実装
```
メインエリアにタブ構造を実装してください。

タブ:
1. ダッシュボード（メイン画面）
2. 取引先分析
3. セグメント分析

各タブは今は空のフレームで構いません。
タブ切り替え時にprint文でどのタブが選択されたか出力してください。
```

---

## Phase 2-2: グラフ実装

### プロンプト 2-2-A: matplotlib埋め込み基盤
```
matplotlibのグラフをCustomTkinterに埋め込む基盤を作成してください。

要件:
- FigureCanvasTkAggを使用
- 日本語フォント対応（IPAexGothicまたはMS Gothic）
- グラフの再描画メソッドを用意
- ダッシュボードタブ内に2x2のグリッドでグラフを配置できるようにする

まずはダミーの折れ線グラフが表示されることを確認してください。
```

### プロンプト 2-2-B: 月次推移グラフ
```
ダッシュボードタブに月次推移グラフを実装してください。

要件:
- 折れ線グラフ
- X軸: 月（1〜12月）
- Y軸: 金額（円）
- 年度ごとに異なる色の線
- 凡例を表示
- フィルタ（年度、セグメント、科目）に連動

SQLクエリ例:
SELECT year, month, SUM(amount) as total
FROM transactions_denormalized
WHERE account = ? AND year IN (?) AND segment IN (?)
GROUP BY year, month
ORDER BY year, month
```

### プロンプト 2-2-C: セグメント構成比グラフ
```
ダッシュボードタブにセグメント構成比の円グラフを実装してください。

要件:
- 円グラフまたはドーナツグラフ
- セグメント別の構成比を表示
- パーセンテージをラベル表示
- フィルタ（年度、科目）に連動

最新年度のデータをデフォルトで表示してください。
```

### プロンプト 2-2-D: 前年同月比較グラフ
```
ダッシュボードタブに前年同月比較の棒グラフを実装してください。

要件:
- 横棒グラフまたは縦棒グラフ
- 当年と前年の月別データを並べて表示
- 増減がわかりやすい色分け
- フィルタに連動
```

---

## Phase 2-3: データ連携

### プロンプト 2-3-A: データアクセス層
```
models/database.py にデータアクセス層を実装してください。

クラス設計:
- AccountingDatabase クラス
  - __init__(db_path): DB接続
  - get_years(): 年度リスト取得
  - get_segments(): セグメントリスト取得
  - get_accounts(): 科目リスト取得
  - get_monthly_data(years, segments, account): 月次データ取得
  - get_segment_summary(years, account): セグメント別集計
  - get_customer_ranking(year, account, limit): 取引先ランキング
  - get_industry_summary(year, account): 業種別集計
  - close(): 接続クローズ

pandasのDataFrameを返すようにしてください。
```

### プロンプト 2-3-B: フィルタ連動
```
フィルタパネルの変更をグラフに反映する仕組みを実装してください。

要件:
- フィルタ変更時にコールバックでグラフを更新
- 複数グラフが同時に更新される
- 更新中はローディング表示（可能であれば）
- エラー時はメッセージ表示
```

---

## Phase 2-4: 追加機能

### プロンプト 2-4-A: サマリーパネル
```
ダッシュボードタブの上部にサマリーパネルを追加してください。

表示項目:
- 選択期間の合計金額（¥XX,XXX,XXX形式）
- 前年比（+XX.X%または-XX.X%、色分け）
- 取引先数
- 取引件数

カード形式で横並びに表示してください。
```

### プロンプト 2-4-B: 取引先分析画面
```
取引先分析タブを実装してください。

内容:
1. 取引先ランキング表（売上高TOP20）
   - 順位、取引先名、業種、金額を表示
   - TreeViewまたはテーブルウィジェットを使用
2. 業種別構成比グラフ（円グラフ）
3. 取引先選択で月次推移を表示する機能

年度フィルタに連動してください。
```

### プロンプト 2-4-C: CSVエクスポート
```
現在表示中のデータをCSVエクスポートする機能を追加してください。

要件:
- ツールバーまたはメニューに「エクスポート」ボタン
- ファイル保存ダイアログを表示
- UTF-8 with BOMで出力（Excel対応）
- ファイル名はデフォルトで「会計データ_YYYYMMDD.csv」
```

---

## Phase 2-5: exe化・配布準備

### プロンプト 2-5-A: exe化準備
```
PyInstallerでexe化するための準備をしてください。

要件:
- specファイルの作成
- 必要なデータファイル（accounting.db）の同梱設定
- アイコンファイルの設定（あれば）
- 隠しインポートの設定（CustomTkinter, matplotlib等）

build.bat または build.sh も作成してください。
```

### プロンプト 2-5-B: exe化実行
```
PyInstallerでexe化を実行してください。

オプション:
- --onedir（フォルダ形式、デバッグしやすい）
- --windowed（コンソール非表示）
- --name "会計ダッシュボード"

ビルド後、dist/ フォルダの内容を確認し、起動テストしてください。
```

### プロンプト 2-5-C: README作成
```
配布用のREADME.txtを作成してください。

内容:
- アプリの概要
- 動作環境（Windows 10/11）
- 起動方法
- 使い方（簡易マニュアル）
- データベースファイルの場所
- トラブルシューティング
```

---

## トラブルシューティング用プロンプト

### 日本語文字化け対応
```
matplotlibのグラフで日本語が文字化けしています。
日本語フォントを正しく設定してください。

Windows環境では「MS Gothic」または「Meiryo」が使えます。
フォントが見つからない場合のフォールバックも設定してください。
```

### exe化エラー対応
```
PyInstallerでexe化したらエラーが発生しました。
以下のエラーメッセージを解析して対処法を教えてください。

[エラーメッセージをここに貼り付け]
```

### パフォーマンス改善
```
フィルタ変更時のグラフ更新が遅いです。
以下の観点で改善してください:
- SQLクエリの最適化
- データのキャッシュ
- 描画の効率化
```

---

## 補足: GUIフレームワーク変更時

もしCustomTkinter以外を使いたい場合は、以下のプロンプトで変更できます。

### Flet版
```
CustomTkinterの代わりにFletを使用してアプリを実装し直してください。
Fletはモダンなクロスプラットフォームフレームワークで、exe化も容易です。
基本的な画面構成は同じで、Fletのウィジェットに置き換えてください。
```

### Dear PyGui版
```
CustomTkinterの代わりにDear PyGuiを使用してアプリを実装し直してください。
Dear PyGuiは高速な描画が特徴で、グラフ表示に向いています。
組み込みのプロットライブラリを使用してください。
```
